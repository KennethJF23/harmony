<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Audio File Generator - Harmony App</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    .container {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    }
    h1 { margin-top: 0; text-align: center; }
    .btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      width: 100%;
      margin: 10px 0;
      transition: transform 0.2s;
    }
    .btn:hover { transform: scale(1.05); }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .log {
      background: rgba(0,0,0,0.3);
      padding: 15px;
      border-radius: 10px;
      margin-top: 20px;
      max-height: 300px;
      overflow-y: auto;
      font-family: 'Courier New', monospace;
      font-size: 14px;
    }
    .log-item { margin: 5px 0; }
    .success { color: #4ade80; }
    .info { color: #60a5fa; }
    .warning { color: #fbbf24; }
    .progress {
      width: 100%;
      height: 20px;
      background: rgba(0,0,0,0.3);
      border-radius: 10px;
      overflow: hidden;
      margin: 10px 0;
    }
    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #4ade80, #60a5fa);
      width: 0%;
      transition: width 0.3s;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üéµ Harmony Audio Generator</h1>
    <p style="text-align: center; opacity: 0.9;">
      Generate placeholder audio files for development.<br>
      <strong>Replace with professional recordings for production!</strong>
    </p>

    <button class="btn" onclick="generateAllAudio()">
      üöÄ Generate All Audio Files
    </button>

    <div class="progress" id="progressContainer" style="display: none;">
      <div class="progress-bar" id="progressBar"></div>
    </div>

    <div class="log" id="log">
      <div class="log-item info">Ready to generate audio files...</div>
    </div>

    <div style="margin-top: 20px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px; font-size: 12px;">
      <strong>üìå Important Notes:</strong>
      <ul style="margin: 10px 0;">
        <li>Binaural beats (Alpha, Beta, Gamma, Theta, Delta) are generated in real-time by the app</li>
        <li>These placeholder files let you test the audio system immediately</li>
        <li>For production, replace with high-quality audio (320kbps MP3, FLAC, or WAV)</li>
        <li>Ensure audio files are loopable with seamless transitions</li>
      </ul>
      <strong>üéØ Recommended Sources:</strong>
      <ul style="margin: 10px 0;">
        <li><a href="https://freesound.org" target="_blank" style="color: #60a5fa;">Freesound.org</a> - Free ambient sounds</li>
        <li><a href="https://www.bensound.com" target="_blank" style="color: #60a5fa;">Bensound</a> - Royalty-free music</li>
        <li>Generate with Audacity (free) or Adobe Audition</li>
      </ul>
    </div>
  </div>

  <script>
    const audioFiles = {
      focus: [
        { name: 'alpha-focus.mp3', duration: 60, description: 'Alpha Focus Wave (8-12 Hz)' },
        { name: 'beta-focus.mp3', duration: 60, description: 'Beta Focus Wave (13-30 Hz)' },
        { name: 'gamma-focus.mp3', duration: 60, description: 'Gamma Focus Wave (30-100 Hz)' },
      ],
      relax: [
        { name: 'theta-relax.mp3', duration: 60, description: 'Theta Relaxation (4-8 Hz)' },
        { name: 'alpha-calm.mp3', duration: 60, description: 'Alpha Calm Wave' },
      ],
      deep: [
        { name: 'deep-focus.mp3', duration: 60, description: 'Deep Focus Session' },
        { name: 'study-wave.mp3', duration: 60, description: 'Study Wave' },
      ],
      ambient: [
        { name: 'rain.mp3', duration: 60, description: 'Rain Ambience' },
        { name: 'ocean.mp3', duration: 60, description: 'Ocean Waves' },
        { name: 'wind.mp3', duration: 60, description: 'Wind Sounds' },
        { name: 'whistle.mp3', duration: 60, description: 'Whistle Melody' },
        { name: 'white-noise.mp3', duration: 60, description: 'White Noise' },
        { name: 'forest.mp3', duration: 60, description: 'Forest Ambience' },
        { name: 'nature.mp3', duration: 60, description: 'Nature Sounds' },
      ]
    };

    function log(message, type = 'info') {
      const logEl = document.getElementById('log');
      const item = document.createElement('div');
      item.className = `log-item ${type}`;
      item.textContent = message;
      logEl.appendChild(item);
      logEl.scrollTop = logEl.scrollHeight;
    }

    function updateProgress(current, total) {
      const percent = (current / total) * 100;
      document.getElementById('progressBar').style.width = percent + '%';
    }

    async function generateSilentAudio(duration) {
      const sampleRate = 44100;
      const numChannels = 2;
      const numSamples = sampleRate * duration;

      // Create offline audio context
      const offlineCtx = new OfflineAudioContext(numChannels, numSamples, sampleRate);
      
      // Create a buffer with silence (all zeros)
      const buffer = offlineCtx.createBuffer(numChannels, numSamples, sampleRate);
      
      // Optionally add subtle pink noise to make it more realistic
      for (let channel = 0; channel < numChannels; channel++) {
        const data = buffer.getChannelData(channel);
        let b0 = 0, b1 = 0, b2 = 0, b3 = 0, b4 = 0, b5 = 0, b6 = 0;
        for (let i = 0; i < numSamples; i++) {
          const white = (Math.random() * 2 - 1) * 0.01; // Very quiet
          b0 = 0.99886 * b0 + white * 0.0555179;
          b1 = 0.99332 * b1 + white * 0.0750759;
          b2 = 0.96900 * b2 + white * 0.1538520;
          b3 = 0.86650 * b3 + white * 0.3104856;
          b4 = 0.55000 * b4 + white * 0.5329522;
          b5 = -0.7616 * b5 - white * 0.0168980;
          data[i] = (b0 + b1 + b2 + b3 + b4 + b5 + b6 + white * 0.5362) * 0.11;
          b6 = white * 0.115926;
        }
      }

      const source = offlineCtx.createBufferSource();
      source.buffer = buffer;
      source.connect(offlineCtx.destination);
      source.start();

      return await offlineCtx.startRendering();
    }

    function audioBufferToWav(buffer) {
      const numChannels = buffer.numberOfChannels;
      const sampleRate = buffer.sampleRate;
      const format = 1; // PCM
      const bitDepth = 16;

      const bytesPerSample = bitDepth / 8;
      const blockAlign = numChannels * bytesPerSample;

      const data = [];
      for (let i = 0; i < buffer.length; i++) {
        for (let channel = 0; channel < numChannels; channel++) {
          const sample = buffer.getChannelData(channel)[i];
          const int16 = Math.max(-1, Math.min(1, sample)) * 0x7FFF;
          data.push(int16 & 0xFF);
          data.push((int16 >> 8) & 0xFF);
        }
      }

      const dataSize = data.length;
      const buffer_size = 44 + dataSize;

      const arrayBuffer = new ArrayBuffer(buffer_size);
      const view = new DataView(arrayBuffer);

      const writeString = (offset, string) => {
        for (let i = 0; i < string.length; i++) {
          view.setUint8(offset + i, string.charCodeAt(i));
        }
      };

      writeString(0, 'RIFF');
      view.setUint32(4, buffer_size - 8, true);
      writeString(8, 'WAVE');
      writeString(12, 'fmt ');
      view.setUint32(16, 16, true);
      view.setUint16(20, format, true);
      view.setUint16(22, numChannels, true);
      view.setUint32(24, sampleRate, true);
      view.setUint32(28, sampleRate * blockAlign, true);
      view.setUint16(32, blockAlign, true);
      view.setUint16(34, bitDepth, true);
      writeString(36, 'data');
      view.setUint32(40, dataSize, true);

      for (let i = 0; i < data.length; i++) {
        view.setUint8(44 + i, data[i]);
      }

      return arrayBuffer;
    }

    async function generateAllAudio() {
      const btn = event.target;
      btn.disabled = true;
      document.getElementById('progressContainer').style.display = 'block';
      document.getElementById('log').innerHTML = '';

      log('üéµ Starting audio generation...', 'info');

      let totalFiles = 0;
      let currentFile = 0;

      // Count total files
      Object.values(audioFiles).forEach(files => {
        totalFiles += files.length;
      });

      for (const [category, files] of Object.entries(audioFiles)) {
        log(`\nüìÅ Generating ${category} files...`, 'info');

        for (const file of files) {
          try {
            log(`  ‚è≥ ${file.description}...`, 'info');
            
            // Generate audio buffer
            const audioBuffer = await generateSilentAudio(file.duration);
            
            // Convert to WAV
            const wavBuffer = audioBufferToWav(audioBuffer);
            const blob = new Blob([wavBuffer], { type: 'audio/wav' });
            
            // Download
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${category}-${file.name.replace('.mp3', '.wav')}`;
            a.click();
            URL.revokeObjectURL(url);
            
            currentFile++;
            updateProgress(currentFile, totalFiles);
            
            log(`  ‚úÖ ${file.description} - Ready!`, 'success');
            
            // Small delay to prevent browser hanging
            await new Promise(resolve => setTimeout(resolve, 100));
            
          } catch (error) {
            log(`  ‚ùå Error: ${file.name} - ${error.message}`, 'warning');
          }
        }
      }

      log('\n‚ú® Audio generation complete!', 'success');
      log('üìù Move generated files to public/audio/ folders', 'warning');
      log('‚ö†Ô∏è  Remember: Replace with real audio for production!', 'warning');

      btn.disabled = false;
    }
  </script>
</body>
</html>
